define([
  "dojo/_base/declare"

, "dijit/Dialog"

, "hotplate/hotClientDojo/widgets/ViewingWidget"

, "hotplate/bd/WorkspacesMessages/WorkspacesSelectContactFrom"
, "hotplate/bd/UsersConfig"


], function(
  declare

, Dialog

, ViewingWidget

, WorkspacesSelectContactFrom
, UsersConfig

){

  return declare( [ ViewingWidget ], {

  	templateString: '' +
      '<span class="user-top-box">\n' +
      '  <span data-dojo-attach-point="nameNode" data-dojo-attach-event="ondijitclick:showUserConfig"></span>\n' +
      '</span>\n'+
      '',

   renderInfo: function(){
      this.nameNode.innerHTML = this.info.workspacesContacts.data.firstName;
    },

    postMixInProperties: function(){

      this.info = { 
        workspacesContacts: {
          data: this.contact,
          id: this.contact.id,
          storeParameters: { workspaceId: this.contact.workspaceId }
        }
      };
    },

    postCreate: function(){
      
      this.inherited(arguments);

      // The user-wide configuration dialog
      this.userDialog = new Dialog( {
        title: "Your account",
        className: 'users-config',
      });
      this.userDialog.addChild( new UsersConfig({
        userId: this.contact.userId
      }) );
      this.userDialog.startup();

    },

 
    showUserConfig: function(){
      this.userDialog.show();
    },

  });

});



