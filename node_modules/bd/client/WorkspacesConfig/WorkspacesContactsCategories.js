/*
INPUT:
* workspaceId 
DESCRIPTION
An editable list of user categories available for this workspace (`workspacesContactsCategories`). Each `workspacesContact` will be assigned a `workspacesContactsCategories`.
*/
define([
  "dojo/_base/declare"

, "dijit/form/ValidationTextBox"

, "put-selector/put"

, "hotplate/hotClientDojo/dgridWidgets/commonMixins"
, "hotplate/hotClientDojo/widgets/EditingWidget"
, "hotplate/hotClientDojo/dgridWidgets/EditableList"
, "hotplate/hotClientDojo/widgets/BusyButton"

], function(
  declare

, ValidationTextBox

, put

, commonMixins
, EditingWidget
, EditableList
, BusyButton

){
  return declare( [ EditableList ], {

    ownClass: 'workspaces-contacts-categories',

    //initialFilter: { enabled: true },

    postMixInProperties: function(){
      this.inherited(arguments);

      this.storeParameters = { workspaceId: this.workspaceId };
    },

    ListConstructor: declare( [ commonMixins.FullOnDemandList ], {

      renderRow: function(object, options){
        var row = put('div.row', object.name + ( ! object.enabled ? " (deleted)" : '' ) );
        return row;
      },
      
      dndParams: { selfAccept: true },
    }),

    EditingWidgetConstructor: declare([ EditingWidget ], {
      templateString: '' +
        '<div>\n' +
        '  <div class="inline-form">\n' +
        '    <form data-dojo-type="dijit/form/Form" data-dojo-attach-point="formWidget" method="POST">\n' +
        '      <input id="${id}_name" name="name" data-dojo-type="dijit/form/ValidationTextBox" maxlength="50" data-dojo-props="required:true" data-dojo-attach-point="nameWidget" />\n' +
        '      <input class="form-submit" type="submit" data-dojo-attach-point="buttonWidget" data-dojo-type="hotplate/hotClientDojo/widgets/BusyButton" label="Update" />' +
        '    </form>\n'+
        '  </div>\n'+
        '</div>\n'+
        '',
        alertBarDomPlacement: 'last',
        startup: function(){
          this.inherited(arguments);
          this.nameWidget.focus();
        },

    }),

    AddingWidgetConstructor: declare( [ EditingWidget ], {
      templateString: '' +
        '<div>\n' +
        '  <div class="inline-form">\n' +
        '    <form data-dojo-type="dijit/form/Form" data-dojo-attach-point="formWidget" method="POST">\n' +
        '      <div class="inputField">\n' +
        '        <input id="${id}_name" name="name" data-dojo-type="dijit/form/ValidationTextBox" maxlength="50" data-dojo-props="required:true, placeHolder:\'Type a category here...\'" data-dojo-attach-point="nameWidget, focusNode" />\n' +
        '        <input class="form-submit" type="submit" data-dojo-attach-point="buttonWidget" data-dojo-type="hotplate/hotClientDojo/widgets/BusyButton" label="Add" />\n' +
        '      </div>\n'+
        '    </form>\n'+
        '  </div>\n'+
        '</div>\n'+
        '',
        resetOnSuccess: true,
        alertBarDomPlacement: 'last',
    }),

    storeName: 'workspacesContactsCategories',
    editingWidgetPlacement: 'inline',
    multipleEditingAllowed: true,
    addingWidgetPosition: 'top',
    gutters: false,

    buttonsPosition: 'after', // or "top" or "bottom"
  } );

});



