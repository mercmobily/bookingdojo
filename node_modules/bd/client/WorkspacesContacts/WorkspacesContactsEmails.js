define([
  "dojo/_base/declare"

, "dijit/form/ValidationTextBox"

, "put-selector/put"

, "hotplate/hotDojoDgridWidgets/commonMixins"
, "hotplate/hotDojoWidgets/EditingWidget"
, "hotplate/hotDojoDgridWidgets/EditableList"
, "hotplate/hotDojoWidgets/BusyButton"
, "hotplate/hotDojoStores/stores"
, "hotplate/hotDojoGlobals/globals"

, "hotplate/bd/WorkspacesContacts/WorkspacesContactsEmailsThings"

], function(
  declare

, ValidationTextBox

, put

, commonMixins
, EditingWidget
, EditableList
, BusyButton
, stores
, globals

//, WorkspacesContactsEmailsThings

){

  var templateString = '' +
    '<div>\n' +
    '  <div class="inline-form">\n' +
    '    <form data-dojo-type="dijit/form/Form" data-dojo-attach-point="formWidget" method="POST">\n' +
    '      <input id="${id}_email" name="email" data-dojo-type="dijit/form/ValidationTextBox" maxlength="70" data-dojo-props="required: true" data-dojo-attach-point="emailWidget" />\n' +
    '      <input class="form-submit" type="submit" data-dojo-attach-point="buttonWidget" data-dojo-type="hotplate/hotDojoWidgets/BusyButton" label="Save" />' +
    
//    '    <div data-dojo-attach-point="workspacesContactsEmailsThingsNode" />\n' +

    '    </form>\n'+
    '  </div>\n'+
    '</div>\n'+
    '';

  return declare( [ EditableList ], {

    //'class': 'small-editable-list-autoheight',

    refreshOnSubmit: false,
    immediateRefresh: false,

    ListConstructor: declare( [ commonMixins.FullOnDemandList ], {

      renderRow: function(object, options){
        var row = put('div.row', object.email );
        return row;
      },
      queryOptions: { placeNew: 'last' },
      dndParams: { selfAccept: true },
    }),

    EditingConstructor: declare([ EditingWidget ], {
      templateString: templateString,
      alertBarDomPlacement: 'last',
      postCreate: function(){
        this.inherited(arguments);
        var self = this;

/*
        self.workspacesContactsEmailsThings = new WorkspacesContactsEmailsThings({
          storeParameters: self.storeParameters,
          storeExtraParameters: { emailId: self.recordId }
        }, self.workspacesContactsEmailsThingsNode );
*/  

      
      },     

/*
      startup: function(){
        this.inherited(arguments);
        this.workspacesContactsEmailsThings.startup();
      },
*/ 


    }),


    storeName: 'WorkspacesContactsEmails',
    editingWidgetPlacement: 'dialog',
    multipleEditingAllowed: false,
    addingWidgetRegion: 'top',
    gutters: false,
    buttonsPosition: 'after', // or "top" or "bottom"
  } );

});



